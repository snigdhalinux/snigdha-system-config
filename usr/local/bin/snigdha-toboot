#!/bin/bash
#set -e

# Author    : Erik Dubois
# Website   : https://www.erikdubois.be

if lsblk | grep -q "/boot/efi" ; then

	echo "###############################################################################"
	echo "Re-installing the default systemd-boot from Snigdha OS"
	echo "###############################################################################"

	sudo pacman -S --noconfirm kernel-install-mkinitcpio

	sudo bootctl install
	sudo reinstall-kernels

	if [[ -f /boot/efi/loader/loader.conf ]];then
		sudo sed -i "s/#timeout 3/timeout 3/g" /boot/efi/loader/loader.conf
	fi

	if [[ -f /boot/efi/loader/loader.conf ]];then
		sudo sed -i "s/#console-mode keep/console-mode keep/g" /boot/efi/loader/loader.conf
	fi

	echo
	echo "###############################################################################"
	echo "###                DONE - YOU CAN CLOSE THIS WINDOW                        ####"
	echo "###############################################################################"

else

	echo
	echo "###############################################################################"
	echo "###                YOU CAN NOT GOT TO SYSTEMD-BOOT                         ####"
	echo "###                        KEEP USING GRUB                                 ####"
	echo "###        https://wiki.archlinux.org/title/Arch_boot_process              ####"
	echo "###############################################################################"
fi
